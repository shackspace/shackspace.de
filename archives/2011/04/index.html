<!DOCTYPE html><html><head><meta charset="utf8"><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="/css/vendor.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Maven+Pro|Muli|Play|Quattrocento+Sans|Quicksand|Ropa+Sans|Source+Code+Pro|Ubuntu"><meta name="author" content="John Doe"><meta name="description" content="shackspace = der hackerspace in stuttgart &amp;raquo; Werkstatt, Treffpunkt, Vereinsheim für Nerds &amp;amp; freundliche Digitalkultur"><title>shackspace</title></head><body><nav class="primary"><a class="logo" href="/"><img class="logo" src="/img/logo-white-bg-no-tagline.svg" alt="shackspace"></a><div class="links"><a href="/announcements">Announcements</a><a href="/events">Events</a><a href="#">Projects</a><a href="https://wiki.shackspace.de">Wiki</a><a href="/location">Location</a></div></nav><div class="posts"><article class="post post-compact"><h2 class="post-title"><a href="/2011/04/27/open-sesame-harddrive-password-hacking-with-a-openbench-logic-sniffer/">Open Sesame: Harddrive Password Hacking with a OpenBench Logic Sniffer </a></h2><div class="post-excerpt"><p><a href="https://blog.shackspace.de/wp-content/uploads/2011/04/DSC_2881.jpg" target="_blank" rel="external"><img src="https://blog.shackspace.de/wp-content/uploads/2011/04/DSC_2881-150x150.jpg" alt="" title="Laptop harddrive wired up for bus sniffing"></a>shackspace’s @<a href="https://twitter.com/dop3j0e" target="_blank" rel="external">dop3j0e</a> had a big problem.  A password problem.  Quite a while ago he set up a password for his Thinkpad’s harddrive and chose to unlock his drive using the built-in fingerprint scanner.  Years passed, thumbs were drawn over the scanner countless times, passwords were changed frequently.  But not all passwords were changed.  That one password for his harddrive never did change and over time he simply forgot what the actual password was.</p>
<p>The thumb print scanner kept working.  However, to change or disable the password you have to enter it by keyboard in the BIOS since in this case it does not accept the thumb print scanner as input.<br>This poses a real problem.  How do you access the disk if your fingerprint scanner dies?  Or what if the laptop dies and you have to unlock the drive from a different machine that doesn’t have the password stored in the fingerprint scanner?</p>
<p><a id="more"></a>There’s various approaches to go about this issue.<br>One idea was  to reverse engineer the BIOS to find out where the actual password is stored.  This turned out to be especially nasty business and while a lot of insight was gained into how (ugly) a BIOS looks from the inside, no password was recovered.<br>Another idea which does not work was exchanging the control board of the harddrive with that of a similar model. Turns out the harddrive password is stored on the platter, not the controller.<br>You could of course use a logic sniffer (costs multiple kilo-Euros) and sniff the IDE bus for the password being transmitted.  Not really an option either… or is it?</p>
<h3 id="Open-Source-Hardware-to-the-Rescue"><a href="#Open-Source-Hardware-to-the-Rescue" class="headerlink" title="Open Source Hardware to the Rescue"></a>Open Source Hardware to the Rescue</h3><p><a href="https://blog.shackspace.de/wp-content/uploads/2011/04/101721653.jpg" target="_blank" rel="external"><img src="https://blog.shackspace.de/wp-content/uploads/2011/04/101721653-150x150.jpg" alt="" title="OpenBench Logic Sniffer"></a>Thanks to the open source hardware movement, you can have a logic sniffer for just $50!  The <a href="http://www.seeedstudio.com/depot/open-workbench-logic-sniffer-p-612.html?cPath=174" target="_blank" rel="external">OpenBench Logic Sniffer</a> is exactly what you want and @<a href="https://twitter.com/hdznrrd" target="_blank" rel="external">hdznrrd</a> at shackspace just happened to receive his first batch pre-order at the exact time @dop3j0e was about to fall into despair.</p>
<p>The OBLS comes with 16 buffered (3.3 or 5V) pins and another 16 unbuffered (3.3V only) pins.  The <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Parallel_ATA" target="_blank" rel="external">IDE bus</a> happens to be a 5V bus, ruling out half of the capture pins, and to sniff everything you’d need 40 pins.</p>
<p>It turns out it’s good enough to just sniff the data pins and nothing else (details below).  And yes, the IDE bus has exactly 16 data pins :)</p>
<h3 id="Sniffing-the-IDE-bus-for-the-Password-Transfer"><a href="#Sniffing-the-IDE-bus-for-the-Password-Transfer" class="headerlink" title="Sniffing the IDE bus for the Password Transfer"></a>Sniffing the IDE bus for the Password Transfer</h3><p><a href="https://blog.shackspace.de/wp-content/uploads/2011/04/DSC_2883.jpg" target="_blank" rel="external"><img src="https://blog.shackspace.de/wp-content/uploads/2011/04/DSC_2883-150x150.jpg" alt="" title="In-line sniffing setup"></a>Next it was time to hook up the harddrive to the sniffer.  What makes this slightly complicated is that you have to sniff the bus while the harddrive is mounted inside the laptop.<br>To do this individual wires were connected to each of the 16 data pins.  Since the drive bay wasn’t large enough to accommodate the wiring, the laptop had to be partially disassembled.</p>
<p>The OBLS is compatible with the <a href="http://www.sump.org/projects/analyzer/client/" target="_blank" rel="external">SUMP Logic Analyzer GUI</a> which was used to control the analyzer and set up triggering.</p>
<p>The sniffer was set up to start logging data as soon as the 0xF2 unlock command is seen on the data bus which is then followed by the plain text password, which is exactly what you need to unlock the drive yourself. A from-memory reconstruction of the trigger settings can be found <a href="https://blog.shackspace.de/gallery/index.php/Projekte/Festplattenpasswort-sniffen/sump-trigger-settings" target="_blank" rel="external">here</a>.</p>
<p>Below screenshot shows the SUMP GUI displaying the results of a successful password sniffing run (note the ‘f2’ command).  <em>Note: the Prezi presentation linked below contains an <strong>annotated</strong> full length  screen capture of the sniffed password.</em></p>
<p><a href="https://blog.shackspace.de/wp-content/uploads/2011/04/sump_trigger.png" target="_blank" rel="external"><img src="https://blog.shackspace.de/wp-content/uploads/2011/04/sump_trigger-300x115.png" alt="" title="Trigger and 0xf2 command in SUMP"></a></p>
<h3 id="Unlocking-the-Drive"><a href="#Unlocking-the-Drive" class="headerlink" title="Unlocking the Drive"></a>Unlocking the Drive</h3><p>Now the drive can be unlocked using the handy hdparm tool:</p>
<pre># hdparm --user-master u --security-unlock \
  $(echo -ne "\036\023\042\046\006\002\004\013")</pre>
Once unlocked, the password can be disabled entirely:
<pre># hdparm --user-master u --security-disable \
  $(echo -ne "\036\023\042\046\006\002\004\013")</pre>

<h3 id="Metafoo"><a href="#Metafoo" class="headerlink" title="Metafoo"></a>Metafoo</h3><ul>
<li>@dop3j0e’s presentation “<a href="http://prezi.com/k1xduox30soj/open-sesame/" target="_blank" rel="external">Open Sesame</a>“ on how he hacked his harddrive</li>
<li><a href="http://www.shackspace.de/gallery/index.php/Projekte/Festplattenpasswort-sniffen" target="_blank" rel="external">Photo documentation of the project</a><br><strong>Update #1</strong>: Exchanged the SUMP screenshot with one that actually shows the 0xf2 command.<strong><br>Update #2</strong>: Added more info why sniffing of the password was necessary.<strong><br>Update #3</strong>: Added link to the trigger settings.<div id="_mcePaste" style="position: absolute; left: -10000px; top: 495px; width: 1px; height: 1px; overflow: hidden;"><a href="http://www.shackspace.de/gallery/index.php/Projekte/Festplattenpasswort-sniffen" target="_blank" rel="external">http://www.shackspace.de/gallery/index.php/Projekte/Festplattenpasswort-sniffen</a></div></li>
</ul>
</div></article><article class="post post-compact"><h2 class="post-title"><a href="/2011/04/27/cooking-weekend-2-to-5-whole-rainbow-trout-slow-cooked-pork-fillet-chicken-korma-curry-apple-rolls/">Cooking Weekend #2 to #5: Whole Rainbow Trout, Slow-Cooked Pork Fillet, Chicken Korma, Curry, Apple Rolls</a></h2><div class="post-excerpt"><p>As <a href="/?p=1943">previously mentioned</a>, we’ve had a nice long Easter weekend with lots of cooking going on at shackspace.</p>
<p>After a really nice BBQ session on Friday, Saturday started off with a shopping spree.  A rough total of 280 EUR was spent on food alone which turned out to be a worthwhile investment :)</p>
<p><strong>shackspace Easter weekend menu</strong></p>
<ul>
<li><em>Friday</em>: BBQ w/ <a href="/?p=1943">original Thuringian sausage</a> and <a href="https://blog.shackspace.de/wiki/doku.php?id=rezept:mariande:sweet_spicy_habanero" target="_blank" rel="external">honey/habanero marinated</a> pork steaks</li>
<li><em>Caturday</em>: <a href="https://blog.shackspace.de/wiki/doku.php?id=rezept:whole_rainbow_trout" target="_blank" rel="external">Whole rainbow trout</a> served on rice with a side of mixed vegetables</li>
<li><em>Sunday</em>: Two kinds of <a href="https://blog.shackspace.de/wiki/doku.php?id=rezept:slow-cooked_pork_fillet" target="_blank" rel="external">slow-cooked pork fillet</a> served with asparagus  and sauce hollandaise and a side of <a href="https://blog.shackspace.de/wiki/doku.php?id=rezept:caramelized_cocktail_tomatoes" target="_blank" rel="external">caramelized cocktail tomatoes</a></li>
<li><em>Monday</em>: Chicken korma served on rice</li>
<li><em>Tuesday</em>: <a href="https://blog.shackspace.de/wiki/doku.php?id=rezept:veggy_mango_curry" target="_blank" rel="external">Mango/vegetable curry</a>, apple/cinnamon rolls</li>
</ul>
</div></article><article class="post post-compact"><h2 class="post-title"><a href="/2011/04/24/cooking-weekend-1-bbq-w-thuringian-sausage-and-habanerohoney-pork-steak/">Cooking Weekend #1: BBQ w/ Thuringian Sausage and Habanero/Honey Pork Steak</a></h2><div class="post-excerpt"><p>@<a href="https://twitter.com/SaijSaij" target="_blank" rel="external">SaijSaij</a> provided us with the most awesome and authentic <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Thuringian_sausage" target="_blank" rel="external">Thuringian sausages</a>.  Being a native Thuringian himself he of course brought the real product after returning from a trip back home.  Just plain delicious!  If you’ve never tasted the real thing, you’re definitely missing out.  By the way, for that little extra, drip some <a href="http://www.koestritzer.de/" target="_blank" rel="external">Koestritzer</a> over the sausages while they’re on the grill and make sure the coals are no longer burning and not too hot.</p>
<p>On top of that there was pork fillet marinated in @<a href="https://twitter.com/hdznrrd" target="_blank" rel="external">hdznrrd</a>‘s <a href="https://blog.shackspace.de/wiki/doku.php?id=rezept:mariande:sweet_spicy_habanero" target="_blank" rel="external">honey/habanero marinade</a>.</p>
</div></article><article class="post post-compact"><h2 class="post-title"><a href="/2011/04/15/einfuhrung-in-final-cut-express-4/">Vortrag/Workshop: Einführung in Final Cut Express 4</a></h2><div class="post-excerpt"><p>shackspace Mitglied h0uz3 wird am <strong>Oster-Samstag </strong>den<strong> 23. April </strong>um <strong>15 Uhr</strong> eine an Anfänger gerichtete Einführung in den Videoschnitt mit <em>Final Cut Express 4</em> geben.  Da Plätze für diesen kostenfreien Event nur in sehr begrenztem Umfang vorhanden sind, bitten wir vorab um eine <a href="https://terminplaner.dfn.de/foodle.php?id=nbueynrcjme4mavt" target="_blank" rel="external">kurze Anmeldung</a>.</p>
<p>Bitte tragt euch auch in den Planer ein, falls ihr gerne teilnehmen möchtet, der Termin aber unpassend ist.  Dadurch können wir später entscheiden, ob der Event möglicherweise wiederholt werden soll.</p>
</div></article><article class="post post-compact"><h2 class="post-title"><a href="/2011/04/14/how-to-hack-a-phone-booth/">How to Hack a Phone Booth</a></h2><div class="post-excerpt"><object style="height: 390px; width: 640px"><param name="movie" value="http://www.youtube.com/v/N7OPHj8Ledg?version=3"><param name="allowFullScreen" value="true"><param name="allowScriptAccess" value="always"><embed src="http://www.youtube.com/v/N7OPHj8Ledg?version=3" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" width="500" height="300"></object>

<p>Above video shows the Half-Life inspired dramatization of how to disassemble the classic German yellow phone booth (replicas only of course, and only for educational purposes).<br>It’s a piece of cake to take off the top, the door, even the floor.  There’s a very limited number of bolts that need to be removed by counter-boring to get the floor and top removed, everything else is held together by screws.  But once you’re left with the three remaining sides, things get tricky.<br>Here’s how you do it.</p>
<p>All round corners are clipped in place but the clip needs some force to get unclipped (the metal thing pried loose in the video is one half of the clip).<br>We’ll start off with the easiest of the four corner pieces, the door hinge.  You do not actually have to remove this part, but it’s first of all quite easy to do and it gives you nice insight into what the clip mechanism looks like, which is crucial to understand to allow you to remove the rear corner pieces.</p>
<ol>
<li>Remove the three screws holding the round corner piece of the door hinge in place.</li>
<li><p>The door hinge corner piece can be pried loose easily once the screws are removed (use crowbar).<br>Now, for the two rear pieces.</p>
</li>
<li><p>Use a crowbar to push the corner upwards by around 2 to 3cm.<br>You can do this by placing the crowbar between the rounded-off top of the rear corner and the two side walls and use it as a lever to push the corner upwards.</p>
</li>
<li>Force the crowbar down into the gap you just created and try to unclip the top most clip.</li>
<li>Start pulling on the corner piece in a diagonally outward direction.</li>
<li>While pulling, use the crowbar to pry each clip loose from top to bottom.</li>
<li>Once the corner piece is gone, remove the screws holding each clip in place.</li>
<li>The clips now pull right off the corner, allowing you to take the walls apart.<br>Disclaimer: two phone booth replicas have been slightly hurt in the making of this video.</li>
</ol>
</div></article><article class="post post-compact"><h2 class="post-title"><a href="/2011/04/09/shackspace-2-0-too-many-things-happening/">shackspace 2.0: too many things happening</a></h2><div class="post-excerpt"><p>We’ve been a bit quiet of the last few days.  For one there’s simply too much happening right now.</p>
<p>Good news: We accidentally the whole internet connection!<br>“The what?”, you say? Yes, the whole internet connection.<br>shackspace now has a 50/10Mbit line connected.  At first try on the advertised day on top of that.  Took some punching of the tech guys and various levels of social engineering using phone numbers you’re not usually supposed to call, but a team of fellow hackers managed to get everything in order.</p>
<p>Omnomnomnom is the word of the next item on the list.  A very short term (&lt;2h) decision one Monday night resulted in shackspace now having not only a softdri^W club-mate vending machine. No, we now have a snack vending machine!</p>
<p>We’ve also had significant upgrades on the storage front.  Large numbers of sheet metal selfs have been acquired off eBay at discount prices.  Finally enough storage space for all our stuff (for now).</p>
<p>The portal system is working again as well, at least for one of the two doors we  need to control.  Properly implementing the system for the outside door  will set us back at least 600 EUR.  Yikes.</p>
</div></article></div><nav class="pagination"><span class="page-number current">1</span></nav><footer><a href="/impressum">Impressum</a></footer></body></html>