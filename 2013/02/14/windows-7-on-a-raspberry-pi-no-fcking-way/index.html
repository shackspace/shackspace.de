<!DOCTYPE html><html><head><meta charset="utf8"><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="/css/vendor.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Maven+Pro|Muli|Play|Quattrocento+Sans|Quicksand|Ropa+Sans|Source+Code+Pro|Ubuntu"><meta name="author" content="John Doe"><meta name="description" content="shackspace = der hackerspace in stuttgart &amp;raquo; Werkstatt, Treffpunkt, Vereinsheim für Nerds &amp;amp; freundliche Digitalkultur"><title>Windows 7 on a Raspberry Pi - No f*cking way! &mdash;&nbsp;shackspace</title></head><body><nav class="primary"><a class="logo" href="/"><img class="logo" src="/img/logo-white-bg-no-tagline.svg" alt="shackspace"></a><div class="links"><a href="/announcements">Announcements</a><a href="/events">Events</a><a href="#">Projects</a><a href="https://wiki.shackspace.de">Wiki</a><a href="/location">Location</a></div></nav><article class="post"><h2 class="post__title">Windows 7 on a Raspberry Pi - No f*cking way!</h2><div class="post__body"><p><img src="https://blog.shackspace.de/wp-content/uploads/2013/02/SANY0388-150x150.jpg" alt="SANY0388"> Here at the <a href="https://blog.shackspace.de/" target="_blank" rel="external">shackspace</a> we love pointing our 50W lazor towards all kinds of materials for fun, more benefit and no profit … yet! The only slight downside is that the laser can (at the moment) only be controlled through a quirky Windows software - the reverse engineering job is still pending. Also there’s a lot of people around which just <em>had</em> to buy “a few” Raspberry Pies when it came out as new - ultra-affordable mini-PC last year.</p>
<p>While looking for use cases for the new toy we discovered that it makes an awesome  (literally) thin client. It has a very low power consumption ~2W and manages to handle remote desktop applications reasonably fast.</p>
<p>To combine both pain (Windows Krepelsoftware) and pleasure (RasPI) the motivation for this project is to provide a means to control the laser cutter - and since the software for controlling it only runs on Windows - without requiring a native Windows computer (which concerns most people around here).</p>
<a id="more"></a>
<p><img src="https://blog.shackspace.de/wp-content/uploads/2013/02/IMG_20130105_031135-1-150x150.jpg" alt="IMG_20130105_031135 (1)">The first thing we did was to set up a Windows 7 OS in a <a href="http://en.wikipedia.org/wiki/Kernel-based_Virtual_Machine" target="_blank" rel="external">KVM instance</a> on one of the servers of  shackspace’s data center.<br>Next we had to find a way to boot directly to that machine which lead us to using xtightvncviewer - which gives the impression of running Windows 7 natively (fullscreen with the resolution of the TFT Screen). <a href="https://blog.shackspace.de/wiki/doku.php?id=berries#thin_client" target="_blank" rel="external">For setup instructions please check the shackspace wiki</a>.</p>
<p>Now we were faced with the challenge to forward the USB port of the Raspberry Pi - to which we were planning to connect the laser cutter to - to our virtual Windows machine. This creates the ‘physical link from the laser cutter to the virtual host.</p>
<p>The solution we stumbled across was the <a href="http://usbip.sourceforge.net/" target="_blank" rel="external">USBIP project</a>.<br>Since the USBIP modules are only in available in staging we needed to build a whole new Linux kernel for the Raspberry Pi as the module is not natively included into the current baseline kernel. It took about two days to make it work - mainly because we didn’t have much experience building kernels beforehand. You can find <a href="https://blog.shackspace.de/wiki/doku.php?id=berries#usbip" target="_blank" rel="external">detailed instructions on USBIP on the shackspace wiki</a>. The result is a clean Raspberry Pi image with the loadable USBIP module included.  We started out building only the required modules and such mischiefs - instructions for building a kernel that lets you actually load the modules you built (as usip-host in our case) will follow shortly.</p>
<p>In addition to that there is at the moment a mismatch of the USB packet headers sent between the USBIP Linux server and Windows client. This caused far more head-ache than expected - partly because of our combined lack of knowledge of the Windows platform. Fortunately our Google-Fu was strong and we were able to find  a  Windows client which is working with the current USBIP release somewhere on the internet.</p>
<p>After quite a few non-booting Linux images, tons of blue screens and kernel panics the results were satisfying and we remotely lazored the no-fucking sign:</p>
<p><img src="https://blog.shackspace.de/wp-content/uploads/2013/02/IMG_20130105_052653-150x150.jpg" alt="IMG_20130105_052653"></p>
<p>We were asked to make some pictures or a video - and since we don’t take ourselves too serious - we came up with the idea of doing it with one of the mascots hanging out in our hackerspace (next up shaqueline?!).</p>
<p>So here we go: Pedro the bear explains how he got Windows 7 running on an Raspberry Pi to control the 50W Lazor of shackspace:</p>
<iframe src="http://www.youtube.com/embed/WYQyUqFck6I?feature=player_detailpage" height="360" width="640" allowfullscreen frameborder="0"></iframe>

<p>Software used:</p>
<ul>
<li><a href="http://usbip.sourceforge.net/" target="_blank" rel="external">USBIP</a></li>
<li><p><a href="https://blog.shackspace.de/wiki/doku.php?id=project:minikrebs#instacam" target="_blank" rel="external">Instacam</a><br>People involved:</p>
</li>
<li><p><a href="https://twitter.com/excogitation" target="_blank" rel="external">exco</a>, <a href="https://twitter.com/makefoo" target="_blank" rel="external">makefu</a> - project owners</p>
</li>
<li><a href="twitter.com/rel0c8">rel0c</a> - admin</li>
<li>nadka - video editing</li>
<li>Pedro the Bear - protagonist, being generally awesome</li>
</ul>
</div></article><footer><a href="/impressum">Impressum</a></footer></body></html>